# 8. Базовая организация вычислений в декларативной модели

Декларативная вычислительная модель основана на простой операционной семантике (смысл программы определяется её выполнением на абстрактной вычислительной машине) и позволяет рассуждать о корректности и сложности программы простым путём. Это вид абстрактной машины с высоким уровнем абстракции, никак не связанный с регистрами, адресами памяти и т. п.

В общем случае команды декларативной программы выполняются последовательно одна за другой. Это напоминает императивный стиль, за исключением того, что допускаются лишь однократные присваивания.

Допускается явно определять локальные видимости переменных (идентификаторов), где каждое новое локальное определение создаёт новый образ переменной, физически отличающийся от предыдущих (но с тем же именем). Это так называемая статическая видимость (static scoping), когда достаточно лишь просмотреть текст программы, чтобы понять видимость идентификатора, не выполняя программу или не анализируя её сложными способами.

Параметры процедур передаются по ссылке: чтобы получить какой-то результат её работы, надо указать в качестве соответствующего аргумента неинициализированную (пока не связанную со значением) переменную, в которую внутри процедуры запишется результат (свяжется с этой переменной, и она станет определённой).

# Базовая организация вычислений в декларативной модели - 2

В теле процедуры могут использоваться переменные, не определённые внутри неё и не входящие в число параметров -- это так называемые свободные идентификаторы. Однако значения этих переменных (с учётом возможной вложенности видимости) будут такими, какими они были на момент определения процедуры, которое может располагаться в любой части кода, так как это обычная операция, выполняющаяся наравне с другими. Это важный нюанс: в популярных языках программирования определения функций полностью отделены от исполняемого кода в том смысле, что они отдельно выделяются компилятором, и никак не "выполняются".
Такая схема называется статическая видимость.

А в декларативной модели определение процедуры -- это тоже фактически инструкция, последовательно исполняемый код.

Если в языке программирования подразумевается, что значения свободных переменных используются в момент вызова процедуры, в её контексте видимости на тот момент, это называется динамическая видимость (dynamic scoping), которая на самом деле принята по умолчанию в большинстве популярных языков программирования.

Однако и формально корректнее, и так рекомендуется в программной инженерии, чтобы все "внешние" определения в теле процедуры формировались именно в момент определения самой процедуры, иначе она начинает зависеть от окружения, в котором вызывается. На практике так не делается потому, что определение функций -- это не исполняемая операция языка, а то, что делается на этапе компиляции. А чтобы избежать негативных эффектов динамической видимости, обычно доступ из функций к свободным переменным либо вообще запрещён, либо настоятельно не рекомендуется.

Любая инструкция программы может быть выделена в процедуру -- простым помещением её внутрь определения процедуры. Это называется процедурная абстракция.

Процедурная абстракция совместно со статической видимостью -- это один из наиболее мощных и чистых (не допускающих побочных эффектов) программистских инструментов, который вдобавок реализуется легко и просто.
